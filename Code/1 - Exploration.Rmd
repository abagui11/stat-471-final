---
title: "1 - Exploration.R"
---

```{r coin-price-histograms}
# load libraries
library(kableExtra)                     # for printing tables
library(cowplot)                        # for side by side plots
library(tidyverse)

# read in the train data for exploration
crypto_train = read_csv("/Users/ArpanBagui/Documents/UPenn/Classes/stat-471-final/Data/clean/crypto_train.csv")

# create histogram of coin prices for each test coin
#ethereum
p1 = crypto_train %>% filter(coin_name == "ethereum") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Ethereum Price ($)", 
       y = "Count") +
  theme_bw()

#cardano
p2 = crypto_train %>% filter(coin_name == "cardano") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Cardano Price ($)", 
       y = "Count") +
  theme_bw()

#ripple
p3 = crypto_train %>% filter(coin_name == "ripple") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Ripple Price ($)", 
       y = "Count") +
  theme_bw()

#dogecoin
p4 = crypto_train %>% filter(coin_name == "dogecoin") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Dogecoin Price ($)", 
       y = "Count") +
  theme_bw()

#chainlink
p5 = crypto_train %>% filter(coin_name == "chainlink") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Chainlink Price ($)", 
       y = "Count") +
  theme_bw()

#monero
p6 = crypto_train %>% filter(coin_name == "monero") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Monero Price ($)", 
       y = "Count") +
  theme_bw()

#filecoin
p7 = crypto_train %>% filter(coin_name == "filecoin") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Filecoin Price ($)", 
       y = "Count") +
  theme_bw()

#tezos
p8 = crypto_train %>% filter(coin_name == "tezos") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Tezos Price ($)", 
       y = "Count") +
  theme_bw()

#stellar
p9 = crypto_train %>% filter(coin_name == "stellar") %>%
  ggplot(aes(x = price)) +
  geom_histogram(bins = 30) +
  labs(x = "Stellar Price ($)", 
       y = "Count") +
  theme_bw()

# combine the plots
price_hists = cowplot::plot_grid(p1, p2, p3, p4, p5, p6, p7, p8, p9, nrow = 3)

# save the histogram
ggsave(filename = "../Results/coin-price-histogram.png", 
       plot = price_hists, 
       device = "png", 
       width = 10, 
       height = 6)
```

```{r likes-scatterplots}
#examining 3 test coins and their relationship to reddit upvotes, twitter favorites, and youtube likes
#this may give us a feel of which social media has a stronger relationship with price

#ethereum reddit
p1 = crypto_train %>% filter(coin_name == "ethereum") %>%
  ggplot(aes(x = r_upvotes, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "orange") +
  labs(x = "Average Reddit Upvotes on r/ethereum", 
       y = "Price",
       title = "Ethereum Reddit") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#ethereum twitter
p2 = crypto_train %>% filter(coin_name == "ethereum") %>%
  ggplot(aes(x = t_favorites, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "light blue") +
  labs(x = "Average Twitter Favorites for top Ethereum tweets", 
       y = "Price",
       title = "Ethereum Twitter") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#ethereum youtube
p3 = crypto_train %>% filter(coin_name == "ethereum") %>%
  ggplot(aes(x = y_likes, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "red") +
  labs(x = "Average Youtube Likes for top Ethereum Videos", 
       y = "Price",
       title = "Ethereum Youtube") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#cardano reddit
p4 = crypto_train %>% filter(coin_name == "cardano") %>%
  ggplot(aes(x = r_upvotes, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "orange") +
  labs(x = "Average Reddit Upvotes on r/cardano", 
       y = "Price",
       title = "Cardano Reddit") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#cardano twitter
p5 = crypto_train %>% filter(coin_name == "cardano") %>%
  ggplot(aes(x = t_favorites, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "light blue") +
  labs(x = "Average Twitter Favorites for top Cardano tweets", 
       y = "Price",
       title = "Cardano Twitter") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#cardano youtube
p6 = crypto_train %>% filter(coin_name == "cardano") %>%
  ggplot(aes(x = y_likes, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "red") +
  labs(x = "Average Youtube Likes for top Cardano Videos", 
       y = "Price",
       title = "Cardano Youtube") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#dogecoin reddit
p7 = crypto_train %>% filter(coin_name == "dogecoin") %>%
  ggplot(aes(x = r_upvotes, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "orange") +
  labs(x = "Average Reddit Upvotes on r/dogecoin", 
       y = "Price",
       title = "Dogecoin Reddit") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#dogecoin twitter
p8 = crypto_train %>% filter(coin_name == "dogecoin") %>%
  ggplot(aes(x = t_favorites, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "light blue") +
  labs(x = "Average Twitter Favorites for top Dogecoin tweets", 
       y = "Price",
       title = "Dogecoin Twitter") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

#dogecoin youtube
p9 = crypto_train %>% filter(coin_name == "dogecoin") %>%
  ggplot(aes(x = y_likes, y = price)) +
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method = "lm", formula = "y~x", se = FALSE, color = "red") +
  labs(x = "Average Youtube Likes for top Dogecoin Videos", 
       y = "Price",
       title = "Dogecoin Youtube") +
  theme_bw() + 
  theme(plot.title = element_text(hjust = 0.5))

# combine the plots
price_scatterplots = cowplot::plot_grid(p1, p2, p3, p4, p5, p6, p7, p8, p9, nrow = 3)

# save the scatterplots
ggsave(filename = "../Results/coin-price-scatterplots.png", 
       plot = price_scatterplots, 
       device = "png", 
       width = 10, 
       height = 6)
```
